# Linux Commands

## ファイルの基本操作

### ファイルのコピー

#### 書式

```
cp {コピー元ファイル名} {コピー先ファイル名}
cp {コピー元ファイル名} {コピー先ディレクトリ}
```



### ファイルの移動

#### 書式

```
mv {移動元ファイル名} {移動先ディレクトリ}
```



### ファイル名の変更

ファイル名の変更も`mv`コマンドを使う

#### 書式

```
mv {移動元ファイル名} {移動先ファイル名}
```



### ファイルの削除

#### 書式

```
rm [オプション] {ファイル名}
```



##### option -i ファイル削除前に確認をする

```
rm -i {ファイル名}
```



## ディレクトリの基本操作

### ディレクトリの作成

#### 書式

```
mkdir [オプション] {ディレクトリ名}
```



##### option -p 複数階層のディレクトリを一度で作る

```
mkdir -p top/sub
```



### ディレクトリのコピー

#### 書式

```
cp -r {コピー元のディレクトリ} {コピー先のディレクトリ}
```

ディレクトリのコピーは`cp`コマンドに`-r`オプションを指定する



### ディレクトリの移動(名前変更)

#### 書式

```
mv {移動前のディレクトリ} {移動後のディレクトリ}
```

ディレクトリの移動は`mv`コマンドを使い、特にオプションも必要ない。

またディレクトリの移動は名前変更と同じなので、名前を変えたい時も`mv`コマンドを使える。



### ディレクトリの削除

#### 書式

```
rm -r {ディレクトリ名}
```

ディレクトリの削除は`rm`に`-r`オプションを指定する。



##### rmdir

ディレクトリ削除には`rmdir`というコマンドも存在するが、こちらのコマンドはディレクトリの中身が空じゃないと削除できない。

```
rmdir {ディレクトリ名}
```





### ツリー構造を表示する

#### 書式

```
tree
```

ディレクトリの構造を見たい時は、構造を見たいディレクトリで`tree`コマンドを使う。



## ファイルとディレクトリの圧縮と展開

### ファイルの圧縮

#### 書式

```
gzip {ファイル名}
```



### ファイルの展開

#### 書式

```
gunzip {ファイル名}
```



### ディレクトリの圧縮

#### 書式

```
tar cvf {アーカイブファイル名} {圧縮するディレクトリ}
```

`cvf`オプションは`create verbose file`で、作成、詳細を表示、ファイル名を指定となる。



### ディレクトリ(アーカイブ)の展開

#### 書式

```
tar xvf {アーカイブファイル名}
```

`x`は`extract`で展開を意味する。



### 圧縮アーカイブの作成と展開

ディレクトリを`tar`でアーカイブにし、アーカイブを`gzip`で圧縮するという一連の動作を`tar`のみで完結することができる。

```
# 作成
tar czvf {アーカイブファイル名} {圧縮するディレクトリ名}

# 展開
tar xzvf {アーカイブファイル名}
```

`z`オプションは`gzip`を意味する。



## ユーザーとグループ

### ユーザIDを確認

#### 書式

```
id [ユーザ名]
```



### ユーザを切り替える

#### 書式

```
su [-] [ユーザ名]
```



##### rootユーザになる

```
su -
```

ユーザ名を指定しないと`root`ユーザになる



##### 指定したユーザになる

```
su - [ユーザ名]
```



##### 補足

```
su
```

このように`-`を付けないで実行した場合も`root`ユーザに切り替える事ができるが、`su -`とした場合と比較して以下のような違いがある。



- rootユーザ用のコマンドの多くが使えない
- カレントディレクトリが元のまま



> rootじゃないと見れないファイルを見るとかそういう時につかう？🤔



### 元のユーザに戻る

#### 書式

```
exit
```

`su`でユーザを切り替えた後、元のユーザーに戻るには`exit`を使う。



### グループを確認する

#### 書式

```
groups [ユーザ名]
```



### ユーザーを作成する (要root)

#### 書式

```
useradd ユーザ名
```



##### 作成したユーザの情報

Linuxのユーザ情報は`/etc/passwd`に記載され、1ユーザの情報は以下の書式で1行で保存されている。

```
ユーザ名:旧パスワード:ユーザID:グループID:コメント:ホームディレクトリ:デフォルトシェル
```







### ユーザーにパスワードを設定する

#### 書式

```
passwd ユーザ名
```



##### パスワードの情報

パスワードは`/etc/shadow`に保存されている。



### ユーザを削除する(要root)

#### 書式

```
user [-r] ユーザ名
```

- `-r`はホームディレクトリを含めて削除するオプション



### グループを作成する(要root)

#### 書式

```
groupadd グループ名
```



##### 作成したグループの情報

Linuxのユーザ情報は`/etc/group`に記載され、1グループの情報は以下の書式で1行で保存されている。

```
グループ名:旧パスワード:グループID:所属ユーザ
```



### グループを削除する(要root)

#### 書式

```
groupdel グループ名
```



### ユーザをグループに参加させる

#### 書式

```
usermod -G グループ名 ユーザ名
```



## パーミッション

### 所有者を変更する

#### 書式

```
chown [-R] 所有者名 ファイル名 or ディレクトリ名
```

- `-R`はディレクトリの中も再帰的に変更するオプション



### グループを変更する

#### 書式

```
chgrp [-R] 所有グループ ファイル名 or ディレクトリ名
```

- `-R`はディレクトリの中も再帰的に変更するオプション



### 所有者とグループを変更する

#### 書式

```
chown [-R] 所有者:所有グループ ファイル名 or ディレクトリ名
```



### パーミッションを変更する

#### 書式

```
chmod [-R] パーミッション ファイル名 or ディレクトリ名
```



#### 例

```
# /tmp/data以下のすべてを777に
chmod -R 777 /tmp/data

# 所有者の書き込み権限を追加
chmod u+w /tmp/data/diary.txt

# 所有者の書き込み権限を削除
chmod u-w /tmp/data/diary.txt
```



#### ディレクトリとパーミッション

| 所有者の権限 | ls   | cd   | cat  | touch | rm   |
| ------------ | ---- | ---- | ---- | ----- | ---- |
| ---          | ×    | ×    | ×    | ×     | ×    |
| r--          | △    | ×    | ×    | ×     | ×    |
| rw-          | △    | ×    | ×    | ×     | ×    |
| r-x          | 〇   | 〇   | 〇   | ×     | ×    |
| rwx          | 〇   | 〇   | 〇   | 〇    | 〇   |



## シェルの便利な機能

### コマンドの履歴を表示する

```
history
```



### コマンドの履歴番号からコマンドを実行する

#### 書式

```
!{コマンドの履歴番号}
```



### エイリアスを設定する

#### 書式

```
alias 別名='コマンド'
```

オプションを指定したコマンドなどに好きな名前を付けておくことができる。



#### 例

```
# ls -lにlslという名前を付ける
alias lsl='ls -l'
```



### シェル変数を設定する

#### 書式

```
変数名=値
```

`=`の前後にスペースは



### シェル変数の値を表示する

#### 書式

```
echo $変数名
```



### 環境変数を設定する

#### 書式

```
export 変数名=値
```


#### 例

```
VAR1=ubuntu
export VAR1
export VAR2=centos
```



### 設定されている環境変数の内容を表示する

#### 書式

```
printenv
```



### 設定されている環境変数とシェル変数を表示する

#### 書式

```
set
```



### コマンドの実行ファイルの場所を探す

#### 書式

```
which コマンド名
```



## ファイルの操作

### locateで探す

#### 書式

```
locate ファイル名パターン
```



### ファイルデータベースを更新

```
updatedb
```

`root`じゃないと警告？エラー？がでた



### findで探す

#### 書式

```
find [検索対象パス] [検索式]
```



#### 実行例

```
# /binの中でcから始まるファイルを探す
find /bin -name "c*"
```

```
# 360日以上アクセスされていないファイルを削除
find -atime +360 -exec rm {} \;
```



### grepでも文字列に一致する内容を探す

#### 書式

```
grep [オプション] [文字列パターン] [検索対象ファイル]
```



### ファイルの先頭を表示

#### 書式

```
head [-行数] {ファイル名}
```



### ファイルの末尾を表示

#### 書式

```
tail [-行数] {ファイル名}
```



### ファイル内容をソートして出力する

#### 書式

```
sort [オプション] [ファイル名]
```



### ファイルに行番号をつけて表示

#### 書式

```
nl [ファイル名]
```



### ファイルの情報を表示

#### 書式

```
wc [オプション] [ファイル名]
```



## パッケージの管理(CentOS)

### RPMについて

RPMはRed Hat社が採用しているパッケージの形式、インストールなどには予めインターネットなどからrpmパッケージファイルをダウンロードしておく必要がある。

### インストール済みRPMパッケージを一覧表示

```
rpm -qa
```



### RPMパッケージの説明を表示

#### 書式

```
rpm -qi パッケージ名
```



#### 例

```
rpm -qi vim-common
```



### RPMパッケージがインストールされているか確認

#### 書式

```
rpm -q パッケージ名
```



#### 例

```
rpm -q postfix
rpm -q httpd
```



### RPMパッケージをインストール

#### 書式

```
rpm -ivh パッケージファイル名
```



#### 例

```
rpm -ivh /tmp/vsftpd-2.2.2-11.el6_3.1.i686.rpm
```



### RPMパッケージをアップデート

#### 書式

```
rpm -Uvh パッケージファイル名
```



#### 例

```
rpm -Uvh /tmp/vsftpd-2.2.2-11.el6_3.1.i686.rpm
```



### RPMパッケージのアンインストール

#### 書式

```
rpm -e パッケージ名
```



#### 例

```
rpm -e vsftpd
```



### YUMについて

yumはパッケージの依存関係を解決して、必要なモノを全ていい感じにインストールしてくれるツール

CentOSのサポートが切れていると失敗するので、基本はサポートされてるバージョンを使ってやること。



### YUMでパッケージをインストールする

#### 書式

```
yum install パッケージ名
```



#### 例

```
yum install httpdrpm 
```



### YUMでパッケージの情報を表示

#### 書式

```
yum info パッケージ名
```



#### 例

```
yum info zsh
```



### YUMでパッケージを検索する

#### 書式

```
yum search パッケージ名
```



#### 例

```
yum search ruby
```



### システム全体をアップデートするコマンド

```
yum update
```





## ファイルシステム

### パーティションの操作

#### 書式

```
fdisk デバイスファイル名
```



#### 例

```
fdisk /dev/sdb
```

既存のパーティションに対して、新規パーティションを作るなどなんらか操作をするとデータが失われたりする可能性があるので気を付けること。(よくわからないなら迂闊にやらない)



### ファイルシステムを作成

#### 書式

```
mkfs [-t ファイルシステム] デバイスファイル名
```



#### 例

```
mkfs -t ext3 /dev/sda5
```



### 外部メディアをマウントする

#### 書式

```
mount デバイスファイル マウントポイント
```

※マウントポイントは任意のパスを指定



#### 例

```
mount /dev/cdrom /media/cdrom
```



### ターミナルの情報を得る

```js
console.log(env.TERM_PROGRAM);
```

**output**

```
'vscode'
```

vscode上で実行した結果。



## プロセス

### プロセスの表示

#### 書式

```
ps [オプション]
```



#### 例

```
# コマンドを実行したユーザが現ターミナルで起動したプロセスを表示
ps

# 他のユーザが実行したプロセスも表示する
ps a

# ユーザ名を表示する
ps u

# ターミナルから実行されたプロセスじゃないプロセスも表示する
ps x

# 上記のオプションを一度に指定
ps aux
```



### プロセスの親子関係を表示

#### 書式

```
pstree [オプション]
```



### プロセスの実行状況を表示

```
top
```



### シグナルを送信

#### 書式

```
kill [シグナルID] プロセスID
kill -s [シグナル名] プロセスID
```



#### 例

```
# 強制終了
kill -s KILL 28000
```



## ジョブ

### 実行中のジョブを確認

```
jobs
```



### ジョブをフォアグラウンドで実行

```
fg [%ジョブID]
```



### ジョブをバックグラウンドで実行

```
bg [%ジョブID]
```



## ネットワーク

### telnet接続

#### 書式

```
telnet 接続先ホスト名 or IPアドレス
```



### ssh接続

```
ssh [ユーザ名@]接続先ホスト名 or IPアドレス
```



### 疎通確認

```
ping 接続先ホスト名 or IPアドレス
```



