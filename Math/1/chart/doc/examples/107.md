# 条件式がある場合の最大・最小(2)

$$
x^2 + y^2 = 4のとき、2y + x^2の最大値と最小値を求めよ。また、その時のx,y の値を求めよ。
$$

## 目的

- $2y + x^2$の最大値と最小値
- 最大値を取る時の$x, y$の値
- 最小値を取る時の$x,y$の値

---

まずは$x^2 + y^2 = 4$の式についてみていく
$$
x^2 + y^2 = 4を変形して、x^2 = 4 - y^2 ... ①
$$

$$
左辺のx^2はかならず0以上になるので、x^2 \ge 0、よって \\
4 - y^2 \ge 0
$$

この方程式を解くと
$$
4 - y^2 \ge 0 \\
(x+2)(x-2) \ge 0 \\
したがって、-2 \le y \le 2 \ ... ②
$$

>この工程では $y$ の取りえる範囲を求めている。答えにはまだ材料は足りないがひとまず$y$の範囲は特定できた。
>
>式を変更することと、$x^2$が0以上という条件を使う事がポイントとなる。

---

最大値、最小値の値はまだわからないが、ひとまずこの値を$P$とおくと、以下のように表せる。

$P = 2y + x^2$



①を使って、$x^2$を置き換えると

$P = 2y + 4 - y^2$、整理して$P = -y^2 + 2y +4$とすると2次式になる。

②によって$y$の取る範囲はわかっているので、定義域においてこの2次方程式の最大値、最小値を求める。


$$
平方完成をし \\
\begin{align}
P &= -y^2 + 2y + 4 \\
&= -(y^2 -2y) + 4 \\
&= -(y-1)^2 +1 +4 \\
&= -(y-1)^2 + 5
\end{align}
$$
ここから、放物線は上に凸であり、頂点(1, 5)をとり、軸は$y=1$とわかる。

> グラフを書いて確認



定義域において

最大値を取るのは$y = 1$のとき、最大値 5

最小値を取るのは$y = -2$のとき、最小値 -4



> この時点で問題の答えである最大値と最小値、またその時の$y$の値が求まった。
>
> あと求めなければいけないのは、$x$だけとなる。

---

①より
$$
y = 1のとき、x^2 = 4 - 1 = 3 \\
x = \pm \sqrt{3}
$$

$$
y = -2のとき、x^2 = 4 - 4 = 0 \\
x = 0
$$

---

したがって

$2y + x^2$について

$最大値は5、その時のx, yの値はx = \pm \sqrt{3}, y = 1$

$最小値は-4、その時のx,yの値はx=0, y=-2$



## まとめ

- $x^2 + y^2 = 4$を$x^2$について解く...①
- $x^2$は0以上という事実から、2次不等式をつくり、$y$の定義域を求める
- $P = 2y + x^2$に①を代入し$yの2次方程式を作る$...②
- ②について最大値、最小値を求める
- 最大値、最小値を取るときの$x, y$の値を求める。



## プログラム的イメージ

```js
// 用意すべき解答
const answer = {
    // 最小値
    min: {
        v:undefined,
        x:undefined,
        y:undefined,
    },
    // 最大値
    max: {
        v:undefined,
        x:undefined,
        y:undefined,
    }
}

// x^2 + y^2 = 4をx^2について解くと
function xx(y) {
    return 4 - y * y;
}

// x^2は0以上なので、0 <= xxを満たさないといけない
if (xx < 0) return;

// 0 <= xxの不等式を解くと、Yの定義域が求まる
const rangeY = (-2 <= y <= 2);

// P = 2y + x^2とおくと
//   = 2y + xx(y)
//   = 2y + 4 - y^2
//   = -y^2 + 2y + 4
function P(y) {
    return -(y*y) + 2*y + 4;
}

// 2次式を平方完成すると、頂点(1, 5)がわかる
const v = [1, 5];

// rangeYにおいて軸がx=1なので、最大値はy = 1のとき、最小値はy=-2のときとわかる
//           軸
// -2 -1  0  1  2
answer.max.v = P(1);
answer.max.y = 1;
answer.min.v = P(-2)
answer.min.y = -2;

// 後は最大、最小をとるyについて、xの値を求めればよい
// xはxxの平方根なので
function x(y) {
    Math.sqrt(xx(y));
}
answer.max.x = x(answer.max.y); // 最大値の時のx
answer.min.x = x(answer.min.y); // 最小値の時のx
```