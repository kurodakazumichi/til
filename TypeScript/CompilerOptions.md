# コンパイラーオプション

`yarn tsc --init`によって生成された`tsconfig.json`
これをもとに各項目について調べる。

公式ドキュメント
https://www.typescriptlang.org/docs/handbook/compiler-options.html


# Basic Options

## target

### 概要

ECMAScriptのターゲットバージョンを指定します

### 設定可能な値

'ES3'（デフォルト）、 'ES5'、 'ES2015'、 'ES2016'、 'ES2017'、 'ES2018'または 'ESNEXT

### 効能

コンパイルで生成されるjsファイルの内容に影響を与える。

#### サンプルコード
```ts
let num = 0;
```

#### target:es5を指定した場合
```js
var num = 0;
```

#### target:es6"を指定した場合
```js
let num = 0;
```

----------------------------------------------------------------------------------------

## module

### 概要

モジュールコードの生成を指定します

### 設定可能な値

'none'、 'commonjs'、 'amd'、 'system'、 'umd'、 'es2015'、または 'ESNext'

### 効能


コンパイルで生成されるjsファイルの内容に影響を与えるには違いないが
このオプションはモジュールに関するコードをどうコンパイルするかという部分に影響する。
(モジュールに関してはcommonjs、esModuleあたりの歴史を学ばないと理解できないと思われ)

### サンプルコード

```ts
import * as Config from './config';
```

#### "es2015"を指定した場合

```js
import * as Config from './config';
```

#### "commonjs"を指定した場合

```js
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Config = require("./config");
```

やる意味はなさそうだけど`target`に`es5`を指定しつつ、`module`を`es2015`と指定する事もできた。
2019年の状況を考えると`target`と`module`のベストプラクティスは:

```
target:es5
module:commonjs
```

になるかなと思う。

----------------------------------------------------------------------------------------

## lib

### 概要

コンパイルに含めるライブラリファイルを指定します。

### 設定可能な値

- ES5
- ES6
- ES2015
- ES7
- ES2016
- ES2017
- DOM
- DOM.Iterable
- WebWorker
- ScriptHost
- ES2015.Core
- ES2015.Collection
- ES2015.Generator
- ES2015.Iterable
- ES2015.Promise
- ES2015.Proxy
- ES2015.Reflect
- ES2015.Symbol
- ES2015.Symbol.WellKnown
- ES2016.Array.Include
- ES2017.object
- ES2017.SharedMemory

### 注意

libが指定されなかった場合は、下記のようにデフォルトのライブラリが注入されます。

#### target ES5の場合**: 

- DOM
- ES5
- ScriptHost

#### target ES6の場合: 

- DOM
- ES6
- DOM.Iterable
- ScriptHost

### 効能

今まではコンパイルで生成されるコードの結果に影響したけど
このオプションはコンパイルそのものに関係するオプション。
以下の例を見た方が早い


#### サンプルコード
```ts
console.log("Hello World");
```

#### lib:["dom"]を指定した場合

問題なくコンパイルされる。

#### lib:["es5"]を指定した場合

コードの`console`の部分に、`console`が見つからないと警告が出て、コンパイルができない。

`console`は`dom`に定義されている？ようでこれを`lib`に含めておかないと
コンパイラが`console`を認識できずにこける。

----------------------------------------------------------------------------------------

## allowJs

### 概要

JavaScriptファイルをコンパイルできるようにします。

### 設定可能な値

`boolean`、デフォルトは`true`

### 効能

拡張子が`.js`担っているファイルもコンパイルされる。


**サンプルケース**

`index.js`だけを用意しコンパイルを実行する

**arrowJs:trueを指定した場合**

> error TS5055: Cannot write file 'path/to/index.js' because it would overwrite input file.

`.js`のファイルをコンパイルしようとするけど、元のファイルを上書きすることになるから書き込めないとエラーになる。
このオプションを許可する場合は、出力先のフォルダも指定する必要がありそうだ。


**arrowJs:falseを指定した場合**

> error TS18003: No inputs were found in config file

コンパイル対象が何もない的なエラーがでて、コンパイル失敗。
ちなみに`.js`ファイルはコンパイルされないが、`.ts`の中で`.js`のファイルを`import`して使うのは問題ない。

----------------------------------------------------------------------------------------

## checkJs

### 概要

`.js`ファイルのエラーを報告します。  
`--allowJs`と組み合わせて使用します。
(このオプションを有効にする場合は、`--arrowJs`に`true`を指定する必要があるってこと)

### 設定可能な値

`boolean`、デフォルトは`false`

### 効能

このオプションの指す`ファイルのエラー`はTypeScriptに関連したエラーのようだ。

例えば:
```ts
let hoge = 10a;
```

こんな風に、普通のSyntaxエラーがある場合は、`--CheckJs`の設定にかかわらずエラーが表示される。

ではどんなエラーなら表示されるのかというと 

例えば、未使用のローカル変数を許可しないというオプションを設定した場合

```ts
let hoge = 10;
```

このコードをコンパイルすると

> error TS6133: 'hoge' is declared but its value is never read.

というエラーが表示される。

`--CheckJs`はJavaScript的にはOKだが  
コンパイラ的にNGなものをエラーとして報告するかどうかを指定するオプション。


----------------------------------------------------------------------------------------

## jsx

### 概要

.tsxファイルでJSXをサポートする。


### 設定可能な値

- preserve
- react
- react-native

### 効能


**サンプルコード**

```ts
const comp = (<div />);
```

| jsx | 出力されるコード | 出力されるファイルの拡張子 | 備考 |
| - | - | - | - |
| preserve | `var comp = (<div />);` | `.jsx` | コードはそのまま、拡張子だけが`.tsx` -> `.jsx`になる |
| react    | `React.createElement("div");` | `.js` | Reactをimportしてないとコンパイルエラー |
| react-native    | `var comp = (<div />);` | `.js` |  |


このオプションを指定しなくても`.tsx`という拡張子のファイルもコンパイルはされる。
ただこのオプションを指定しないと`JSX記法`は使えない。

----------------------------------------------------------------------------------------

## declaration

### 概要

ソースコードに対応する`.d.ts`ファイルを生成する。

### 設定可能な値

`boolean`、デフォルトは`false`

### 効能

`true`を指定してコンパイルすると
`index.ts`があった場合は、`index.d.ts`というファイルが生成される。

1ファイルにつき、1つの`.d.ts`が生成される。



----------------------------------------------------------------------------------------

## declarationMap

### 概要

対応する各「.d.ts」ファイルのソースマップを生成します。

### 設定可能な値

`boolean`、デフォルトは`false`

----------------------------------------------------------------------------------------

## declarationDir

### 概要

対応する各「.d.ts」ファイルの出力先を指定します

### 設定可能な値

`string`で出力先のパスを設定

### 効能

`declarationDir`を指定すると、指定したフォルダに
各種「.d.ts」ファイル、(declarationMapを有効にしている場合はそれらのファイルも)が生成される。

----------------------------------------------------------------------------------------

## sourceMap

### 概要

対応する.mapファイルを生成します。

### 設定可能な値

`boolean`、デフォルトは`false`

----------------------------------------------------------------------------------------

## outFile

### 概要

出力を連結して単一のファイルに出力します。
連結の順序は、トリプルスラッシュ参照およびインポートとともに、コマンドラインでコンパイラに渡されるファイルのリストによって決まります。
詳細については、出力ファイルの順番に関するドキュメントを参照してください。

### 注意

`outFile`を指定する場合は`module`に`amd`か`system`を指定する必要がある。  
それ以外はサポートされていない。

### 設定可能な値

`string`、出力するファイルパス(`./bundle.js`など)


----------------------------------------------------------------------------------------

## ourDir

### 概要

出力先のフォルダを変更する。

### 設定可能な値

`string`、出力するディレクトリパス`./lib`など)

### 効能

コンパイルで生成されたファイルを格納するフォルダを変更できる。
これがないとソースコードと同じ場所にコードが生成されるので必須で指定したいオプションだ。

----------------------------------------------------------------------------------------

## rootDir

### 概要

TypeScriptのソースコードが格納されている`root`ディレクトリを指定する。

### 設定可能な値

`string`、ルートディレクトリパス`./`など)

### 効能

`rootDir`を指定すると、指定したディレクトリの外に`.ts`ファイルをおくことができなくなる。(コンパイルエラーになる)

これを回避するには`exclude`オプションを使用して
`rootDir`の外にあるディレクトリをコンパイル対象外として除外設定を加えることでこの問題を回避できる。

----------------------------------------------------------------------------------------

## removeComments

### 概要

対応する.mapファイルを生成します。

### 設定可能な値

`boolean`、デフォルトは`false`

### 効能


**サンプルコード**

```ts
import * as Config from './config';
```

**"es2015"を指定した場合**


**"commonjs"を指定した場合**

----------------------------------------------------------------------------------------

## removeComments

### 概要

/ *で始まるコピーライトヘッダーコメントを除くすべてのコメントを削除します。
って書いてるけど、普通にコピーライトヘッダも消え去るんですよ。。。

### 設定可能な値

`boolean`、デフォルトは`false`





